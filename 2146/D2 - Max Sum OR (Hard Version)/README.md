<h3><a href="https://codeforces.com/contest/2146/problem/D2" target="_blank" rel="noopener noreferrer">Max Sum OR (Hard Version)</a></h3>

<div class="header"><div class="title">D2. Max Sum OR (Hard Version)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p>   </p><p><span class="tex-font-style-bf">This is the hard version of the problem. The difference between the versions is that in this version, $$$0\leq l\leq r<2^{30}$$$. You can hack only if you solved all versions of this problem.</span> </p><p>You are given two integers $$$l$$$ and $$$r$$$ ($$$l\le r$$$). </p><p>Let $$$n = r - l + 1$$$. We will create two arrays $$$a$$$ and $$$b$$$, both consisting of $$$n$$$ integers. Initially, both $$$a$$$ and $$$b$$$ are equal to $$$[l, l+1, \ldots, r]$$$. You have to reorder the array $$$a$$$ arbitrarily to maximize the following value:</p><p>$$$$$$\sum_{i=1}^n \left (a_i\;|\;b_i \right ).$$$$$$</p><p>Here, $$$|$$$ denotes the <a href="https://en.wikipedia.org/wiki/Bitwise_operation#OR">bitwise OR operation</a>. </p><p>You also need to construct a possible way to reorder the array $$$a$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \le t \le 10^4$$$). The description of the test cases follows. </p><p>The only line of each test case contains two integers $$$l$$$ and $$$r$$$ ($$$0\leq l \leq r<2^{30}$$$) — the minimum and maximum elements in $$$a$$$.</p><p>Let $$$n = r - l + 1$$$. It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2\cdot 10^5$$$. </p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case, print a single integer in the first line of output — the maximum value of $$$\sum\limits_{i=1}^n \left (a_i\;|\;b_i \right )$$$. </p><p>Then, print $$$n$$$ distinct integers $$$a_1, a_2, \ldots,a_n$$$ in the second line — the array $$$a$$$ after reordering.</p><p>If there are multiple answers, you may print any of them.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id008003535201467192" id="id0009747014938734389" class="input-output-copier">Copy</div></div><pre id="id008003535201467192"><div class="test-example-line test-example-line-even test-example-line-0">7</div><div class="test-example-line test-example-line-odd test-example-line-1">0 3</div><div class="test-example-line test-example-line-even test-example-line-2">0 9</div><div class="test-example-line test-example-line-odd test-example-line-3">0 15</div><div class="test-example-line test-example-line-even test-example-line-4">6 10</div><div class="test-example-line test-example-line-odd test-example-line-5">1 4</div><div class="test-example-line test-example-line-even test-example-line-6">3 6</div><div class="test-example-line test-example-line-odd test-example-line-7">1000000007 1000000009</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id007136787635462737" id="id008773018488844209" class="input-output-copier">Copy</div></div><pre id="id007136787635462737"><div class="test-example-line test-example-line-odd test-example-line-1">12</div><div class="test-example-line test-example-line-odd test-example-line-1">3 2 1 0 </div><div class="test-example-line test-example-line-even test-example-line-2">90</div><div class="test-example-line test-example-line-even test-example-line-2">7 8 5 4 3 2 9 0 1 6</div><div class="test-example-line test-example-line-odd test-example-line-3">240</div><div class="test-example-line test-example-line-odd test-example-line-3">15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0 </div><div class="test-example-line test-example-line-even test-example-line-4">70</div><div class="test-example-line test-example-line-even test-example-line-4">10 8 7 6 9</div><div class="test-example-line test-example-line-odd test-example-line-5">20</div><div class="test-example-line test-example-line-odd test-example-line-5">2 1 4 3 </div><div class="test-example-line test-example-line-even test-example-line-6">28</div><div class="test-example-line test-example-line-even test-example-line-6">4 3 6 5 </div><div class="test-example-line test-example-line-odd test-example-line-7">3000000039</div><div class="test-example-line test-example-line-odd test-example-line-7">1000000008 1000000007 1000000009 </div></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test case, the reordered array $$$a$$$ is $$$[3,2,1,0]$$$. The value of the expression is $$$(3\;|\;0)+(2\;|\;1)+(1\;|\;2)+(0\;|\;3)=3+3+3+3=12$$$. It can be proved that this is the maximum possible value of the expression.</p><p>In the second test case, the reordered array $$$a$$$ is $$$[7,8,5,4,3,2,9,0,1,6]$$$. The value of the expression is $$$90$$$. It can be proved that this is the maximum possible value of the expression.</p><p>In the third test case, it can be proved that $$$240$$$ is the maximum possible value of the expression.</p><p>In the fourth test case, the reordered array $$$a$$$ is $$$[10,8,7,6,9]$$$. The value of the expression is $$$(10\;|\;6)+(8\;|\;7)+(7\;|\;8)+(6\;|\;9)+(9\;|\;10)=14+15+15+15+11=70$$$. It can be proved that this is the maximum possible value of the expression.</p></div>