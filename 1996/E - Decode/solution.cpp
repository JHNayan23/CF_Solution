#include <bits/stdc++.h>using namespace std; #define int long long int#define endl '\n'#define all(x) x.begin(), x.end() const int M = 1000000007; void solve(){    string s; cin >> s;    int n = s.size();    map<int, int> mp;    mp[0] = 1;     int ans = 0;    int cnt = 0;    for(int i = 0; i < n; i++){        if(s[i] == '1') cnt++;        else cnt--;         ans += ((n - i) * mp[cnt]) % M;        ans %= M;        mp[cnt] += (i + 2);        mp[cnt] %= M;    }     cout << ans << endl;}int32_t main(){    ios_base::sync_with_stdio(0);    cin.tie(0);    int t = 1;    cin >> t;    while (t--)        solve();    return 0;}