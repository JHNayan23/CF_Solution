#include <bits/stdc++.h>using namespace std;//using int long long int;Â int main() {    long long tt;cin>>tt;    while(tt--){      long long n,x;cin>>n>>x;      long long a[n+5],b[n+5];      for(long long i=1;i<=n;i++)cin>>a[i];        sort(a+1,a+n+1);        long long sum=0;        long long l=1,r=n;        long long ans=0;        for(long long i=1;i<=n;i++){          if(sum+a[r]<x)sum+=a[l],b[i]=a[l],l++;          else sum+=a[r]-x,b[i]=a[r],ans+=a[r],r--;        }        cout<<ans<<'\n';        for(long long i=1;i<=n;i++)cout<<b[i]<<" ";        cout<<'\n';          }    return 0;}