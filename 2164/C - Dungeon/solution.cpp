#include <bits/stdc++.h>using namespace std; #define int long long#define endl '\n'#define all(x) x.begin(), x.end() void Aww(map<int, int> &mp, int b[], int c[], int idx[], int cnt, int &ans){    for (int k = 0; k < cnt; ++k)    {        int i = idx[k];        auto it = mp.lower_bound(b[i]);        if (it == mp.end())            continue;        int val = it->first;        if (--(it->second) == 0)            mp.erase(it);        ans++;        int newv = max(val, c[i]);        mp[newv]++;    }} void solve(){    int n, m;    cin >> n >> m;    int a[n], b[m], c[m];    for (int i = 0; i < n; ++i)        cin >> a[i];    for (int i = 0; i < m; ++i)        cin >> b[i];    for (int i = 0; i < m; ++i)        cin >> c[i];     map<int, int> mp;    for (int i = 0; i < n; ++i)        mp[a[i]]++;     int taken[m], notTaken[m];    int tcnt = 0, notcnt = 0;     for (int i = 0; i < m; ++i)    {        if (c[i] > 0)            taken[tcnt++] = i;        else            notTaken[notcnt++] = i;    }     sort(taken, taken + tcnt, [&](int i, int j)         { return b[i] < b[j]; });    sort(notTaken, notTaken + notcnt, [&](int i, int j)         { return b[i] < b[j]; });     int ans = 0;     Aww(mp, b, c, taken, tcnt, ans);     for (int k = 0; k < notcnt; ++k)    {        int i = notTaken[k];        auto it = mp.lower_bound(b[i]);        if (it == mp.end())            continue;        if (--(it->second) == 0)            mp.erase(it);        ans++;    }     cout << ans << endl;} int32_t main(){    ios::sync_with_stdio(false);    cin.tie(nullptr);    int T;    cin >> T;    while (T--)        solve();    return 0;}