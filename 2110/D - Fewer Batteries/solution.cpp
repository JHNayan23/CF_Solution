#include <bits/stdc++.h>using namespace std; #define int long long int#define endl '\n'#define all(x) x.begin(), x.end() vector<int> v;int n, m;vector<vector<pair<int, int>>> g; bool good(int sum){    vector<int> dp(n, -1e9);    dp[0] = min(sum, v[0]);    for (int i = 1; i < n; i++)    {        for (auto &[j, w] : g[i])        {            if (w <= dp[j])            {                dp[i] = max(dp[i], min(v[i] + dp[j], sum));            }        }    }    return (dp[n - 1] >= 0);} void solve(){    cin >> n >> m;    g.clear();    g.resize(n);    v.clear();    v.resize(n);    for (int i = 0; i < n; i++)        cin >> v[i];    for (int i = 0; i < m; i++)    {        int s, t, w;        cin >> s >> t >> w;        s--;        t--;        //w--;        g[t].push_back({s, w});    }     int l = 0, r = 1e9+5, best = r;    while (l <= r)    {        int mid = (l + r) / 2;        if (good(mid))        {            best = min(best, mid);            r = mid - 1;        }        else            l = mid + 1;    }    if (!good(best))        cout << -1 << endl;    else        cout << best << endl;}int32_t main(){    ios_base::sync_with_stdio(0);    cin.tie(0);    int t = 1;    cin >> t;    while (t--)        solve();    return 0;}