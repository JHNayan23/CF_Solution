#include <bits/stdc++.h>using namespace std; #define int long long int#define endl '\n'#define all(x) x.begin(), x.end() void solve(){    int n;    cin >> n;    int q;    cin >> q;    string s;    cin >> s;    int b = count(all(s), 'B');    for (int i = 0; i < q; i++)    {        int x;        cin >> x;        if (b == 0)        {            cout << x << endl;            continue;        }        int j = 0;        int ans = 0;        while (x)        {            ans++;            if (j == n)                j = 0;            if (s[j] == 'A')                x--;            else                x /= 2;            j++;        }        cout << ans << endl;    }}int32_t main(){    ios_base::sync_with_stdio(0);    cin.tie(0);    int t = 1;    cin >> t;    while (t--)        solve();    return 0;}