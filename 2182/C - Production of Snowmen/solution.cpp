#include <bits/stdc++.h>using namespace std; #define int long long int#define endl '\n'#define all(x) x.begin(), x.end() bool yo(vector<int>& a, vector<int>& b, int j, int k, int n){    for(int i = 0; i < a.size(); i++){        if(a[(i + j) % n] >= b[(i + k) % n]) return false;    }    return true;} void solve(){    int n; cin >> n;    vector<int> a(n), b(n), c(n);    for(int i = 0; i < n; i++) cin >> a[i];    for(int i = 0; i < n; i++) cin >> b[i];    for(int i = 0; i < n; i++) cin >> c[i];     int cnt1 = 0, cnt2 = 0;    for(int i = 0; i < n; i++) cnt1 += yo(a, b, i, 0, n);    for(int i = 0; i < n; i++) cnt2 += yo(b, c, 0, i, n);     cout << n * cnt1 * cnt2 << '\n';} int32_t main(){    ios_base::sync_with_stdio(0);    cin.tie(0);    int t = 1;    cin >> t;    while (t--)        solve();    return 0;}