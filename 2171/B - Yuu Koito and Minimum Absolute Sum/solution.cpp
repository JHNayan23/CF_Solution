#include <bits/stdc++.h>using namespace std; #define int long long int#define endl '\n'#define all(x) x.begin(), x.end() void solve(){    int n; cin >> n;    int a[n];    for(int i = 0; i < n; i++){        cin >> a[i];    }     int st = a[0];    int en = a[n - 1];     if(st == -1 and en != -1) a[0] = en;    else if(st != -1 and en == -1) a[n - 1] = st;    else if(st == -1 and en == -1) {        a[0] = 0;        a[n - 1] = 0;    }    for(int i = 0; i < n; i++) if(a[i] == -1 and i != 0 and i != (n - 1)) a[i] = 0;     cout << abs(a[n - 1] - a[0]) << '\n';    for(int i = 0; i < n; i++) cout << a[i] << " "; cout << '\n';}int32_t main(){    ios_base::sync_with_stdio(0);    cin.tie(0);    int t = 1;    cin >> t;    while (t--)        solve();    return 0;}