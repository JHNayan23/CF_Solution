#include <bits/stdc++.h>using namespace std; #define int long long int#define endl '\n'#define all(x) x.begin(), x.end() void solve(){    int n; cin >> n;    int a[n];    for (int i = 0; i < n; i++) cin >> a[i];     int mn = 1e18;    for (int i = 0; i < n - 1; i++) {        mn = min(mn, a[i]);        int s = n - i;        if (mn == s) {            cout << "NO\n";            return;        }    }     cout << "YES\n";     vector<pair<int, int>> ans;    stack<int> st;     mn = 1e18;     for(int i = n - 1; i >= 0; i--){        if(st.empty() || st.top() < a[i]) st.push(a[i]);        else{            int big = st.top();            while(!st.empty() and st.top() > a[i]){                ans.push_back({a[i], st.top()});                st.pop();            }            st.push(big);        }    }     for (auto [f, s] : ans) cout << f << " " << s << "\n";}int32_t main(){    ios_base::sync_with_stdio(0);    cin.tie(0);    int t = 1;    cin >> t;    while (t--)        solve();    return 0;}